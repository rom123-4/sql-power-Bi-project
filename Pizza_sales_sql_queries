-- Total Revenue
SELECT SUM(total_price) AS Total_revenue 
FROM pizza_sales;

-- Average Order Value
SELECT SUM(total_price) / COUNT(DISTINCT order_id) AS Avg_order_value
FROM pizza_sales;

-- Total Quantity of Pizza Sold
SELECT SUM(quantity) AS Total_pizza_sold 
FROM pizza_sales;

-- Total Orders
SELECT COUNT(DISTINCT order_id) AS Total_orders 
FROM pizza_sales;

-- Average Pizzas per Order
SELECT SUM(quantity) / COUNT(DISTINCT order_id) AS Avg_Pizzas_per_order
FROM pizza_sales;

-- Alternative Calculation for Average Pizzas per Order
SELECT CAST(CAST(SUM(quantity) AS DECIMAL(10, 2)) / 
            CAST(COUNT(DISTINCT order_id) AS DECIMAL(10, 2)) AS DECIMAL(10, 2))
AS Avg_Pizzas_per_order
FROM pizza_sales;

-- Update order date format
UPDATE pizza_sales 
SET order_date = STR_TO_DATE(order_date, '%d-%m-%Y');

-- Modify order date column type
ALTER TABLE pizza_sales
MODIFY order_date DATE;

-- Daily Trend of Orders
SELECT DAYNAME(order_date) AS order_day, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DAYNAME(order_date);

-- Monthly Trend of Orders
SELECT MONTHNAME(order_date) AS order_month, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY MONTHNAME(order_date);

-- Percentage of Sales by Pizza Category
SELECT pizza_category, SUM(total_price) * 100 / (SELECT SUM(total_price) FROM pizza_sales) AS PCT
FROM pizza_sales 
GROUP BY pizza_category;

-- Percentage of Sales by Pizza Size
SELECT pizza_size, SUM(total_price) * 100 / (SELECT SUM(total_price) FROM pizza_sales) AS PCT
FROM pizza_sales 
GROUP BY pizza_size;

-- Top 5 Best-Selling Pizzas by Total Revenue
SELECT pizza_name, SUM(total_price) AS total_revenue 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_revenue DESC
LIMIT 5;

-- Bottom 5 Best-Selling Pizzas by Total Revenue
SELECT pizza_name, SUM(total_price) AS total_revenue 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_revenue ASC
LIMIT 5;

-- Top 5 Sellers by Quantity
SELECT pizza_name, SUM(quantity) AS total_quantity 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_quantity DESC
LIMIT 5;

-- Bottom 5 Sellers by Quantity
SELECT pizza_name, SUM(quantity) AS total_quantity 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_quantity ASC
LIMIT 5;

-- Top 5 Pizzas by Total Orders
SELECT pizza_name, COUNT(DISTINCT order_id) AS total_orders 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_orders DESC
LIMIT 5;

-- Bottom 5 Pizzas by Total Orders
SELECT pizza_name, COUNT(DISTINCT order_id) AS total_orders 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_orders ASC
LIMIT 5;
